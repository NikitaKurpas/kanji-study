const sqlite3 = require('sqlite3').verbose();
const path = require('path');

const db = new sqlite3.Database(path.join(__dirname, 'kanji.db'));

// Initialize database
const initDB = () => {
  db.serialize(() => {
    // Create kanji table
    db.run(`
      CREATE TABLE IF NOT EXISTS kanji (
        id INTEGER PRIMARY KEY,
        character TEXT NOT NULL UNIQUE,
        meaning TEXT NOT NULL,
        grade INTEGER NOT NULL, -- The school grade the kanji is typically taught in
        level INTEGER DEFAULT 0,
        last_reviewed TIMESTAMP,
        review_count INTEGER DEFAULT 0
      )
    `);

    // Create words table (for future expansion)
    db.run(`
      CREATE TABLE IF NOT EXISTS words (
        id INTEGER PRIMARY KEY,
        word TEXT NOT NULL UNIQUE,
        reading TEXT NOT NULL,
        meaning TEXT NOT NULL,
        level INTEGER DEFAULT 0,
        last_reviewed TIMESTAMP,
        review_count INTEGER DEFAULT 0
      )
    `);

    // Create word_kanji table (for future expansion)
    db.run(`
      CREATE TABLE IF NOT EXISTS word_kanji (
        word_id INTEGER,
        kanji_id INTEGER,
        FOREIGN KEY (word_id) REFERENCES words (id),
        FOREIGN KEY (kanji_id) REFERENCES kanji (id),
        PRIMARY KEY (word_id, kanji_id)
      )
    `);

    // Create review_history table
    db.run(`
      CREATE TABLE IF NOT EXISTS review_history (
        id INTEGER PRIMARY KEY,
        item_type TEXT NOT NULL,
        item_id INTEGER NOT NULL,
        result BOOLEAN NOT NULL,
        timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
      )
    `);
  });
};

// Parse kanji data from grades 1-5
const parseKanjiData = () => {
  // Grade 1 kanji with meanings
  const grade1Kanji = [
    { character: '一', meaning: 'one' },
    { character: '右', meaning: 'right' },
    { character: '雨', meaning: 'rain' },
    { character: '円', meaning: 'circle, yen' },
    { character: '王', meaning: 'king' },
    { character: '音', meaning: 'sound' },
    { character: '下', meaning: 'below, down' },
    { character: '火', meaning: 'fire' },
    { character: '花', meaning: 'flower' },
    { character: '貝', meaning: 'shell' },
    { character: '学', meaning: 'study, learning' },
    { character: '気', meaning: 'spirit, energy' },
    { character: '九', meaning: 'nine' },
    { character: '休', meaning: 'rest' },
    { character: '玉', meaning: 'ball, jewel' },
    { character: '金', meaning: 'gold, money' },
    { character: '空', meaning: 'sky, empty' },
    { character: '月', meaning: 'moon, month' },
    { character: '犬', meaning: 'dog' },
    { character: '見', meaning: 'see' },
    { character: '五', meaning: 'five' },
    { character: '口', meaning: 'mouth' },
    { character: '校', meaning: 'school' },
    { character: '左', meaning: 'left' },
    { character: '三', meaning: 'three' },
    { character: '山', meaning: 'mountain' },
    { character: '子', meaning: 'child' },
    { character: '四', meaning: 'four' },
    { character: '糸', meaning: 'thread' },
    { character: '字', meaning: 'character' },
    { character: '耳', meaning: 'ear' },
    { character: '七', meaning: 'seven' },
    { character: '車', meaning: 'car' },
    { character: '手', meaning: 'hand' },
    { character: '十', meaning: 'ten' },
    { character: '出', meaning: 'exit' },
    { character: '女', meaning: 'woman' },
    { character: '小', meaning: 'small' },
    { character: '上', meaning: 'above, up' },
    { character: '森', meaning: 'forest' },
    { character: '人', meaning: 'person' },
    { character: '水', meaning: 'water' },
    { character: '正', meaning: 'correct' },
    { character: '生', meaning: 'life' },
    { character: '青', meaning: 'blue' },
    { character: '夕', meaning: 'evening' },
    { character: '石', meaning: 'stone' },
    { character: '赤', meaning: 'red' },
    { character: '千', meaning: 'thousand' },
    { character: '川', meaning: 'river' },
    { character: '先', meaning: 'before, ahead' },
    { character: '早', meaning: 'early' },
    { character: '草', meaning: 'grass' },
    { character: '足', meaning: 'foot, leg' },
    { character: '村', meaning: 'village, town' },
    { character: '大', meaning: 'big, large' },
    { character: '男', meaning: 'man' },
    { character: '竹', meaning: 'bamboo' },
    { character: '中', meaning: 'middle' },
    { character: '虫', meaning: 'insect' },
    { character: '町', meaning: 'town' },
    { character: '天', meaning: 'heaven' },
    { character: '田', meaning: 'rice field' },
    { character: '土', meaning: 'soil, earth' },
    { character: '二', meaning: 'two' },
    { character: '日', meaning: 'day, sun' },
    { character: '入', meaning: 'enter' },
    { character: '年', meaning: 'year' },
    { character: '白', meaning: 'white' },
    { character: '八', meaning: 'eight' },
    { character: '百', meaning: 'hundred' },
    { character: '文', meaning: 'text, writing' },
    { character: '木', meaning: 'tree, wood' },
    { character: '本', meaning: 'book, origin' },
    { character: '名', meaning: 'name' },
    { character: '目', meaning: 'eye' },
    { character: '立', meaning: 'stand' },
    { character: '力', meaning: 'power' },
    { character: '林', meaning: 'woods' },
    { character: '六', meaning: 'six' }
  ];

  // Grade 2 kanji with meanings
  const grade2Kanji = [
    { character: '引', meaning: 'pull' },
    { character: '羽', meaning: 'feather' },
    { character: '雲', meaning: 'cloud' },
    { character: '園', meaning: 'garden' },
    { character: '遠', meaning: 'far' },
    { character: '何', meaning: 'what' },
    { character: '科', meaning: 'subject, course' },
    { character: '夏', meaning: 'summer' },
    { character: '家', meaning: 'house, home' },
    { character: '歌', meaning: 'song' },
    { character: '画', meaning: 'picture' },
    { character: '回', meaning: 'time, round' },
    { character: '会', meaning: 'meeting' },
    { character: '海', meaning: 'sea' },
    { character: '絵', meaning: 'painting' },
    { character: '外', meaning: 'outside' },
    { character: '角', meaning: 'angle, corner' },
    { character: '楽', meaning: 'comfort, music' },
    { character: '活', meaning: 'active' },
    { character: '間', meaning: 'interval, space' },
    { character: '丸', meaning: 'circle, round' },
    { character: '岩', meaning: 'rock' },
    { character: '顔', meaning: 'face' },
    { character: '汽', meaning: 'steam' },
    { character: '記', meaning: 'record' },
    { character: '帰', meaning: 'return' },
    { character: '弓', meaning: 'bow' },
    { character: '牛', meaning: 'cow' },
    { character: '魚', meaning: 'fish' },
    { character: '京', meaning: 'capital' },
    { character: '強', meaning: 'strong' },
    { character: '教', meaning: 'teach' },
    { character: '近', meaning: 'near' },
    { character: '兄', meaning: 'elder brother' },
    { character: '形', meaning: 'shape' },
    { character: '計', meaning: 'measure' },
    { character: '元', meaning: 'origin' },
    { character: '言', meaning: 'say' },
    { character: '原', meaning: 'field, plain' },
    { character: '戸', meaning: 'door' },
    { character: '古', meaning: 'old' },
    { character: '午', meaning: 'noon, sign of the horse' },
    { character: '後', meaning: 'after' },
    { character: '語', meaning: 'language, speech' },
    { character: '工', meaning: 'craft, construction' },
    { character: '公', meaning: 'public' },
    { character: '広', meaning: 'wide' },
    { character: '交', meaning: 'exchange' },
    { character: '光', meaning: 'light' },
    { character: '考', meaning: 'think' },
    { character: '行', meaning: 'go' },
    { character: '高', meaning: 'high' },
    { character: '黄', meaning: 'yellow' },
    { character: '合', meaning: 'join' },
    { character: '谷', meaning: 'valley' },
    { character: '国', meaning: 'country' },
    { character: '黒', meaning: 'black' },
    { character: '今', meaning: 'now' },
    { character: '才', meaning: 'talent' },
    { character: '細', meaning: 'thin' },
    { character: '作', meaning: 'make' },
    { character: '算', meaning: 'calculate' },
    { character: '止', meaning: 'stop' },
    { character: '市', meaning: 'city' },
    { character: '矢', meaning: 'arrow' },
    { character: '姉', meaning: 'elder sister' },
    { character: '思', meaning: 'think' },
    { character: '紙', meaning: 'paper' },
    { character: '寺', meaning: 'temple' },
    { character: '自', meaning: 'self' },
    { character: '時', meaning: 'time' },
    { character: '室', meaning: 'room' },
    { character: '社', meaning: 'company, society' },
    { character: '弱', meaning: 'weak' },
    { character: '首', meaning: 'neck' },
    { character: '秋', meaning: 'autumn' },
    { character: '週', meaning: 'week' },
    { character: '春', meaning: 'spring' },
    { character: '書', meaning: 'write' },
    { character: '少', meaning: 'few' },
    { character: '場', meaning: 'place' },
    { character: '色', meaning: 'color' },
    { character: '食', meaning: 'eat' },
    { character: '心', meaning: 'heart' },
    { character: '新', meaning: 'new' },
    { character: '親', meaning: 'parent' },
    { character: '図', meaning: 'map, drawing' },
    { character: '数', meaning: 'number' },
    { character: '西', meaning: 'west' },
    { character: '声', meaning: 'voice' },
    { character: '星', meaning: 'star' },
    { character: '晴', meaning: 'clear weather' },
    { character: '切', meaning: 'cut' },
    { character: '雪', meaning: 'snow' },
    { character: '船', meaning: 'ship' },
    { character: '線', meaning: 'line' },
    { character: '前', meaning: 'before' },
    { character: '組', meaning: 'group' },
    { character: '走', meaning: 'run' },
    { character: '多', meaning: 'many' },
    { character: '太', meaning: 'thick' },
    { character: '体', meaning: 'body' },
    { character: '台', meaning: 'platform' },
    { character: '地', meaning: 'ground, earth' },
    { character: '池', meaning: 'pond' },
    { character: '知', meaning: 'know' },
    { character: '茶', meaning: 'tea' },
    { character: '昼', meaning: 'daytime, noon' },
    { character: '長', meaning: 'long' },
    { character: '鳥', meaning: 'bird' },
    { character: '朝', meaning: 'morning' },
    { character: '直', meaning: 'straight' },
    { character: '通', meaning: 'pass through' },
    { character: '弟', meaning: 'younger brother' },
    { character: '店', meaning: 'store' },
    { character: '点', meaning: 'point' },
    { character: '電', meaning: 'electricity' },
    { character: '刀', meaning: 'sword' },
    { character: '冬', meaning: 'winter' },
    { character: '当', meaning: 'hit, right' },
    { character: '東', meaning: 'east' },
    { character: '答', meaning: 'answer' },
    { character: '頭', meaning: 'head' },
    { character: '同', meaning: 'same' },
    { character: '道', meaning: 'road, way' },
    { character: '読', meaning: 'read' },
    { character: '内', meaning: 'inside' },
    { character: '南', meaning: 'south' },
    { character: '肉', meaning: 'meat' },
    { character: '馬', meaning: 'horse' },
    { character: '売', meaning: 'sell' },
    { character: '買', meaning: 'buy' },
    { character: '麦', meaning: 'wheat' },
    { character: '半', meaning: 'half' },
    { character: '番', meaning: 'number, turn' },
    { character: '父', meaning: 'father' },
    { character: '風', meaning: 'wind' },
    { character: '分', meaning: 'part, minute' },
    { character: '聞', meaning: 'hear' },
    { character: '米', meaning: 'rice' },
    { character: '歩', meaning: 'walk' },
    { character: '母', meaning: 'mother' },
    { character: '方', meaning: 'direction, way' },
    { character: '北', meaning: 'north' },
    { character: '毎', meaning: 'every' },
    { character: '妹', meaning: 'younger sister' },
    { character: '万', meaning: 'ten thousand' },
    { character: '明', meaning: 'bright' },
    { character: '鳴', meaning: 'chirp, sound' },
    { character: '毛', meaning: 'hair, fur' },
    { character: '門', meaning: 'gate' },
    { character: '夜', meaning: 'night' },
    { character: '野', meaning: 'field' },
    { character: '友', meaning: 'friend' },
    { character: '用', meaning: 'use' },
    { character: '曜', meaning: 'day of week' },
    { character: '来', meaning: 'come' },
    { character: '里', meaning: 'ri, village, parent\'s home' },
    { character: '理', meaning: 'reason' },
    { character: '話', meaning: 'talk' }
  ];

  // Grade 3 kanji with meanings
  const grade3Kanji = [
    { character: '悪', meaning: 'bad, evil' },
    { character: '安', meaning: 'peaceful' },
    { character: '暗', meaning: 'dark' },
    { character: '医', meaning: 'doctor, medicine' },
    { character: '委', meaning: 'committee' },
    { character: '意', meaning: 'meaning' },
    { character: '育', meaning: 'raise, grow' },
    { character: '員', meaning: 'member' },
    { character: '院', meaning: 'institution' },
    { character: '飲', meaning: 'drink' },
    { character: '運', meaning: 'carry, luck' },
    { character: '泳', meaning: 'swim' },
    { character: '駅', meaning: 'station' },
    { character: '央', meaning: 'center' },
    { character: '横', meaning: 'side, horizontal' },
    { character: '屋', meaning: 'roof, shop' },
    { character: '温', meaning: 'warm' },
    { character: '化', meaning: 'change' },
    { character: '荷', meaning: 'luggage' },
    { character: '界', meaning: 'world' },
    { character: '開', meaning: 'open' },
    { character: '階', meaning: 'floor, story' },
    { character: '寒', meaning: 'cold' },
    { character: '感', meaning: 'feeling' },
    { character: '漢', meaning: 'Chinese' },
    { character: '館', meaning: 'building' },
    { character: '岸', meaning: 'shore' },
    { character: '起', meaning: 'wake up' },
    { character: '期', meaning: 'period' },
    { character: '客', meaning: 'guest' },
    { character: '究', meaning: 'research' },
    { character: '急', meaning: 'urgent' },
    { character: '級', meaning: 'class, rank' },
    { character: '宮', meaning: 'shrine, palace' },
    { character: '球', meaning: 'ball' },
    { character: '去', meaning: 'leave' },
    { character: '橋', meaning: 'bridge' },
    { character: '業', meaning: 'business' },
    { character: '曲', meaning: 'curve, music' },
    { character: '局', meaning: 'bureau' },
    { character: '銀', meaning: 'silver' },
    { character: '区', meaning: 'district' },
    { character: '苦', meaning: 'suffering' },
    { character: '具', meaning: 'tool' },
    { character: '君', meaning: 'you' },
    { character: '係', meaning: 'connection' },
    { character: '軽', meaning: 'light' },
    { character: '血', meaning: 'blood' },
    { character: '決', meaning: 'decide' },
    { character: '研', meaning: 'sharpen, study' },
    { character: '県', meaning: 'prefecture' },
    { character: '庫', meaning: 'warehouse' },
    { character: '湖', meaning: 'lake' },
    { character: '向', meaning: 'facing' },
    { character: '幸', meaning: 'happiness' },
    { character: '港', meaning: 'harbor' },
    { character: '号', meaning: 'number' },
    { character: '根', meaning: 'root' },
    { character: '祭', meaning: 'festival' },
    { character: '皿', meaning: 'plate' },
    { character: '仕', meaning: 'serve' },
    { character: '死', meaning: 'death' },
    { character: '使', meaning: 'use' },
    { character: '始', meaning: 'begin' },
    { character: '指', meaning: 'finger, point' },
    { character: '歯', meaning: 'tooth' },
    { character: '詩', meaning: 'poem' },
    { character: '次', meaning: 'next' },
    { character: '事', meaning: 'matter' },
    { character: '持', meaning: 'hold' },
    { character: '式', meaning: 'ceremony' },
    { character: '実', meaning: 'reality' },
    { character: '写', meaning: 'copy' },
    { character: '者', meaning: 'person' },
    { character: '主', meaning: 'main' },
    { character: '守', meaning: 'protect' },
    { character: '取', meaning: 'take' },
    { character: '酒', meaning: 'alcohol' },
    { character: '受', meaning: 'receive' },
    { character: '州', meaning: 'state' },
    { character: '拾', meaning: 'pick up' },
    { character: '終', meaning: 'end' },
    { character: '習', meaning: 'learn' },
    { character: '集', meaning: 'gather' },
    { character: '住', meaning: 'live, dwell' },
    { character: '重', meaning: 'heavy' },
    { character: '宿', meaning: 'lodge' },
    { character: '所', meaning: 'place' },
    { character: '暑', meaning: 'hot' },
    { character: '助', meaning: 'help' },
    { character: '昭', meaning: 'bright' },
    { character: '消', meaning: 'extinguish' },
    { character: '商', meaning: 'commerce' },
    { character: '章', meaning: 'chapter' },
    { character: '勝', meaning: 'win' },
    { character: '乗', meaning: 'ride' },
    { character: '植', meaning: 'plant' },
    { character: '申', meaning: 'say' },
    { character: '身', meaning: 'body' },
    { character: '神', meaning: 'god' },
    { character: '真', meaning: 'true' },
    { character: '深', meaning: 'deep' },
    { character: '進', meaning: 'advance' },
    { character: '世', meaning: 'world, generation' },
    { character: '整', meaning: 'arrange' },
    { character: '昔', meaning: 'long ago' },
    { character: '全', meaning: 'all' },
    { character: '相', meaning: 'mutual' },
    { character: '送', meaning: 'send' },
    { character: '想', meaning: 'think' },
    { character: '息', meaning: 'breath' },
    { character: '速', meaning: 'fast' },
    { character: '族', meaning: 'tribe, family' },
    { character: '他', meaning: 'other' },
    { character: '打', meaning: 'hit' },
    { character: '対', meaning: 'opposite' },
    { character: '待', meaning: 'wait' },
    { character: '代', meaning: 'substitute' },
    { character: '第', meaning: 'ordinal number' },
    { character: '題', meaning: 'topic' },
    { character: '炭', meaning: 'charcoal' },
    { character: '短', meaning: 'short' },
    { character: '談', meaning: 'discuss' },
    { character: '着', meaning: 'wear' },
    { character: '注', meaning: 'pour' },
    { character: '柱', meaning: 'pillar' },
    { character: '丁', meaning: 'town section' },
    { character: '帳', meaning: 'notebook' },
    { character: '調', meaning: 'tone, investigate' },
    { character: '追', meaning: 'chase' },
    { character: '定', meaning: 'determine' },
    { character: '庭', meaning: 'garden' },
    { character: '笛', meaning: 'flute' },
    { character: '鉄', meaning: 'iron' },
    { character: '転', meaning: 'revolve' },
    { character: '都', meaning: 'metropolis' },
    { character: '度', meaning: 'degree' },
    { character: '投', meaning: 'throw' },
    { character: '豆', meaning: 'bean' },
    { character: '島', meaning: 'island' },
    { character: '湯', meaning: 'hot water' },
    { character: '登', meaning: 'climb' },
    { character: '等', meaning: 'etc.' },
    { character: '動', meaning: 'move' },
    { character: '童', meaning: 'child' },
    { character: '農', meaning: 'agriculture' },
    { character: '波', meaning: 'wave' },
    { character: '配', meaning: 'distribute' },
    { character: '倍', meaning: 'double' },
    { character: '箱', meaning: 'box' },
    { character: '畑', meaning: 'field' },
    { character: '発', meaning: 'departure' },
    { character: '反', meaning: 'anti-' },
    { character: '坂', meaning: 'slope' },
    { character: '板', meaning: 'board' },
    { character: '皮', meaning: 'skin' },
    { character: '悲', meaning: 'sad' },
    { character: '美', meaning: 'beauty' },
    { character: '鼻', meaning: 'nose' },
    { character: '筆', meaning: 'brush' },
    { character: '氷', meaning: 'ice' },
    { character: '表', meaning: 'table, surface' },
    { character: '秒', meaning: 'second' },
    { character: '病', meaning: 'illness' },
    { character: '品', meaning: 'goods' },
    { character: '負', meaning: 'lose' },
    { character: '部', meaning: 'part' },
    { character: '服', meaning: 'clothes' },
    { character: '福', meaning: 'luck' },
    { character: '物', meaning: 'thing' },
    { character: '平', meaning: 'flat' },
    { character: '返', meaning: 'return' },
    { character: '勉', meaning: 'diligence' },
    { character: '放', meaning: 'release' },
    { character: '味', meaning: 'taste' },
    { character: '命', meaning: 'life, command' },
    { character: '面', meaning: 'face' },
    { character: '問', meaning: 'question' },
    { character: '役', meaning: 'role' },
    { character: '薬', meaning: 'medicine' },
    { character: '由', meaning: 'reason' },
    { character: '油', meaning: 'oil' },
    { character: '有', meaning: 'have' },
    { character: '遊', meaning: 'play' },
    { character: '予', meaning: 'beforehand' },
    { character: '羊', meaning: 'sheep' },
    { character: '洋', meaning: 'ocean, western' },
    { character: '葉', meaning: 'leaf' },
    { character: '陽', meaning: 'sunshine' },
    { character: '様', meaning: 'manner' },
    { character: '落', meaning: 'fall' },
    { character: '流', meaning: 'flow' },
    { character: '旅', meaning: 'travel' },
    { character: '両', meaning: 'both' },
    { character: '緑', meaning: 'green' },
    { character: '礼', meaning: 'bow, thanks' },
    { character: '列', meaning: 'row' },
    { character: '練', meaning: 'practice' },
    { character: '路', meaning: 'road' },
    { character: '和', meaning: 'peace, Japanese' }
  ];

  // Grade 4 kanji with meanings
  const grade4Kanji = [
    { character: '愛', meaning: 'love' },
    { character: '案', meaning: 'plan' },
    { character: '以', meaning: 'by means of' },
    { character: '衣', meaning: 'clothing' },
    { character: '位', meaning: 'rank' },
    { character: '囲', meaning: 'surround' },
    { character: '胃', meaning: 'stomach' },
    { character: '印', meaning: 'stamp' },
    { character: '英', meaning: 'England, English' },
    { character: '栄', meaning: 'prosperity' },
    { character: '塩', meaning: 'salt' },
    { character: '億', meaning: 'hundred million' },
    { character: '加', meaning: 'add' },
    { character: '果', meaning: 'fruit' },
    { character: '貨', meaning: 'freight' },
    { character: '課', meaning: 'section' },
    { character: '芽', meaning: 'bud' },
    { character: '改', meaning: 'reform' },
    { character: '械', meaning: 'machinery' },
    { character: '害', meaning: 'harm' },
    { character: '街', meaning: 'street' },
    { character: '各', meaning: 'each' },
    { character: '覚', meaning: 'memorize' },
    { character: '完', meaning: 'complete' },
    { character: '官', meaning: 'government' },
    { character: '管', meaning: 'pipe' },
    { character: '関', meaning: 'connection' },
    { character: '観', meaning: 'view' },
    { character: '願', meaning: 'request' },
    { character: '希', meaning: 'hope' },
    { character: '季', meaning: 'season' },
    { character: '紀', meaning: 'chronicle' },
    { character: '喜', meaning: 'rejoice' },
    { character: '旗', meaning: 'flag' },
    { character: '器', meaning: 'container' },
    { character: '機', meaning: 'machine' },
    { character: '議', meaning: 'deliberation' },
    { character: '求', meaning: 'request' },
    { character: '泣', meaning: 'cry' },
    { character: '救', meaning: 'rescue' },
    { character: '給', meaning: 'salary' },
    { character: '挙', meaning: 'raise' },
    { character: '漁', meaning: 'fishing' },
    { character: '共', meaning: 'together' },
    { character: '協', meaning: 'cooperation' },
    { character: '鏡', meaning: 'mirror' },
    { character: '競', meaning: 'compete' },
    { character: '極', meaning: 'extreme' },
    { character: '訓', meaning: 'instruction' },
    { character: '軍', meaning: 'army' },
    { character: '郡', meaning: 'county' },
    { character: '径', meaning: 'diameter' },
    { character: '型', meaning: 'type' },
    { character: '景', meaning: 'scenery' },
    { character: '芸', meaning: 'art' },
    { character: '欠', meaning: 'lack' },
    { character: '結', meaning: 'tie' },
    { character: '建', meaning: 'build' },
    { character: '健', meaning: 'healthy' },
    { character: '験', meaning: 'test' },
    { character: '固', meaning: 'solid' },
    { character: '功', meaning: 'achievement' },
    { character: '好', meaning: 'like' },
    { character: '候', meaning: 'climate' },
    { character: '航', meaning: 'navigation' },
    { character: '康', meaning: 'health' },
    { character: '告', meaning: 'tell' },
    { character: '差', meaning: 'difference' },
    { character: '菜', meaning: 'vegetable' },
    { character: '最', meaning: 'most' },
    { character: '材', meaning: 'material' },
    { character: '昨', meaning: 'yesterday' },
    { character: '札', meaning: 'tag' },
    { character: '刷', meaning: 'printing' },
    { character: '殺', meaning: 'kill' },
    { character: '察', meaning: 'inspect' },
    { character: '参', meaning: 'participate' },
    { character: '産', meaning: 'production' },
    { character: '散', meaning: 'scatter' },
    { character: '残', meaning: 'remain' },
    { character: '士', meaning: 'warrior' },
    { character: '氏', meaning: 'surname' },
    { character: '史', meaning: 'history' },
    { character: '司', meaning: 'director' },
    { character: '試', meaning: 'test' },
    { character: '児', meaning: 'child' },
    { character: '治', meaning: 'cure' },
    { character: '辞', meaning: 'resign' },
    { character: '失', meaning: 'lose' },
    { character: '借', meaning: 'borrow' },
    { character: '種', meaning: 'seed' },
    { character: '周', meaning: 'circumference' },
    { character: '祝', meaning: 'celebrate' },
    { character: '順', meaning: 'order' },
    { character: '初', meaning: 'first' },
    { character: '松', meaning: 'pine tree' },
    { character: '笑', meaning: 'laugh' },
    { character: '唱', meaning: 'chant' },
    { character: '焼', meaning: 'burn' },
    { character: '象', meaning: 'elephant' },
    { character: '照', meaning: 'illuminate' },
    { character: '賞', meaning: 'prize' },
    { character: '臣', meaning: 'retainer' },
    { character: '信', meaning: 'trust' },
    { character: '成', meaning: 'become' },
    { character: '省', meaning: 'ministry' },
    { character: '清', meaning: 'pure' },
    { character: '静', meaning: 'quiet' },
    { character: '席', meaning: 'seat' },
    { character: '積', meaning: 'accumulate' },
    { character: '折', meaning: 'fold' },
    { character: '節', meaning: 'node, season' },
    { character: '説', meaning: 'theory' },
    { character: '浅', meaning: 'shallow' },
    { character: '戦', meaning: 'war' },
    { character: '選', meaning: 'choose' },
    { character: '然', meaning: 'so' },
    { character: '争', meaning: 'conflict' },
    { character: '倉', meaning: 'warehouse' },
    { character: '巣', meaning: 'nest' },
    { character: '束', meaning: 'bundle' },
    { character: '側', meaning: 'side' },
    { character: '続', meaning: 'continue' },
    { character: '卒', meaning: 'graduate' },
    { character: '孫', meaning: 'grandchild' },
    { character: '帯', meaning: 'belt' },
    { character: '隊', meaning: 'group' },
    { character: '達', meaning: 'attain' },
    { character: '単', meaning: 'simple' },
    { character: '置', meaning: 'place' },
    { character: '仲', meaning: 'relationship' },
    { character: '貯', meaning: 'savings' },
    { character: '兆', meaning: 'trillion' },
    { character: '腸', meaning: 'intestines' },
    { character: '低', meaning: 'low' },
    { character: '底', meaning: 'bottom' },
    { character: '停', meaning: 'stop' },
    { character: '的', meaning: 'target' },
    { character: '典', meaning: 'code' },
    { character: '伝', meaning: 'transmit' },
    { character: '徒', meaning: 'follower' },
    { character: '努', meaning: 'toil' },
    { character: '灯', meaning: 'lamp' },
    { character: '堂', meaning: 'hall' },
    { character: '働', meaning: 'work' },
    { character: '特', meaning: 'special' },
    { character: '得', meaning: 'acquire' },
    { character: '毒', meaning: 'poison' },
    { character: '熱', meaning: 'heat' },
    { character: '念', meaning: 'thought' },
    { character: '敗', meaning: 'defeat' },
    { character: '梅', meaning: 'plum' },
    { character: '博', meaning: 'exhibition' },
    { character: '飯', meaning: 'meal' },
    { character: '飛', meaning: 'fly' },
    { character: '費', meaning: 'expense' },
    { character: '必', meaning: 'necessary' },
    { character: '票', meaning: 'ballot' },
    { character: '標', meaning: 'mark' },
    { character: '不', meaning: 'not' },
    { character: '夫', meaning: 'husband' },
    { character: '付', meaning: 'attach' },
    { character: '府', meaning: 'prefecture' },
    { character: '副', meaning: 'vice-' },
    { character: '粉', meaning: 'powder' },
    { character: '兵', meaning: 'soldier' },
    { character: '別', meaning: 'separate' },
    { character: '辺', meaning: 'area' },
    { character: '変', meaning: 'change' },
    { character: '便', meaning: 'convenience' },
    { character: '包', meaning: 'wrap' },
    { character: '法', meaning: 'law' },
    { character: '望', meaning: 'hope' },
    { character: '牧', meaning: 'pasture' },
    { character: '末', meaning: 'end' },
    { character: '満', meaning: 'full' },
    { character: '未', meaning: 'not yet' },
    { character: '脈', meaning: 'pulse' },
    { character: '民', meaning: 'people' },
    { character: '無', meaning: 'nothing' },
    { character: '約', meaning: 'promise' },
    { character: '勇', meaning: 'courage' },
    { character: '要', meaning: 'need' },
    { character: '養', meaning: 'nurture' },
    { character: '浴', meaning: 'bathe' },
    { character: '利', meaning: 'profit' },
    { character: '陸', meaning: 'land' },
    { character: '良', meaning: 'good' },
    { character: '料', meaning: 'fee' },
    { character: '量', meaning: 'quantity' },
    { character: '輪', meaning: 'wheel' },
    { character: '類', meaning: 'type' },
    { character: '令', meaning: 'order' },
    { character: '冷', meaning: 'cold' },
    { character: '例', meaning: 'example' },
    { character: '歴', meaning: 'history' },
    { character: '連', meaning: 'connect' },
    { character: '老', meaning: 'old' },
    { character: '労', meaning: 'labor' },
    { character: '録', meaning: 'record' }
  ];

  // Grade 5 kanji with meanings
  const grade5Kanji = [
    { character: '圧', meaning: 'pressure' },
    { character: '移', meaning: 'move' },
    { character: '因', meaning: 'cause' },
    { character: '永', meaning: 'eternity' },
    { character: '営', meaning: 'manage' },
    { character: '衛', meaning: 'defense' },
    { character: '易', meaning: 'easy' },
    { character: '益', meaning: 'benefit' },
    { character: '液', meaning: 'liquid' },
    { character: '演', meaning: 'perform' },
    { character: '応', meaning: 'respond' },
    { character: '往', meaning: 'journey' },
    { character: '桜', meaning: 'cherry blossom' },
    { character: '恩', meaning: 'kindness' },
    { character: '可', meaning: 'possible' },
    { character: '仮', meaning: 'temporary' },
    { character: '価', meaning: 'value' },
    { character: '河', meaning: 'river' },
    { character: '過', meaning: 'exceed' },
    { character: '賀', meaning: 'congratulations' },
    { character: '快', meaning: 'pleasant' },
    { character: '解', meaning: 'solution' },
    { character: '格', meaning: 'status' },
    { character: '確', meaning: 'certain' },
    { character: '額', meaning: 'amount' },
    { character: '刊', meaning: 'publish' },
    { character: '幹', meaning: 'trunk' },
    { character: '慣', meaning: 'custom' },
    { character: '眼', meaning: 'eye' },
    { character: '基', meaning: 'foundation' },
    { character: '寄', meaning: 'contribute' },
    { character: '規', meaning: 'rule' },
    { character: '技', meaning: 'skill' },
    { character: '義', meaning: 'righteousness' },
    { character: '逆', meaning: 'reverse' },
    { character: '久', meaning: 'long time' },
    { character: '旧', meaning: 'old times' },
    { character: '居', meaning: 'reside' },
    { character: '許', meaning: 'permit' },
    { character: '境', meaning: 'boundary' },
    { character: '均', meaning: 'equal' },
    { character: '禁', meaning: 'prohibition' },
    { character: '句', meaning: 'phrase' },
    { character: '群', meaning: 'group' },
    { character: '経', meaning: 'passage' },
    { character: '潔', meaning: 'clean' },
    { character: '件', meaning: 'matter' },
    { character: '券', meaning: 'ticket' },
    { character: '険', meaning: 'danger' },
    { character: '検', meaning: 'examine' },
    { character: '限', meaning: 'limit' },
    { character: '現', meaning: 'present' },
    { character: '減', meaning: 'decrease' },
    { character: '故', meaning: 'reason' },
    { character: '個', meaning: 'individual' },
    { character: '護', meaning: 'protect' },
    { character: '効', meaning: 'effect' },
    { character: '厚', meaning: 'thick' },
    { character: '耕', meaning: 'till' },
    { character: '鉱', meaning: 'mineral' },
    { character: '構', meaning: 'construct' },
    { character: '興', meaning: 'interest' },
    { character: '講', meaning: 'lecture' },
    { character: '混', meaning: 'mix' },
    { character: '査', meaning: 'investigate' },
    { character: '再', meaning: 'again' },
    { character: '災', meaning: 'disaster' },
    { character: '妻', meaning: 'wife' },
    { character: '採', meaning: 'pick' },
    { character: '際', meaning: 'occasion' },
    { character: '在', meaning: 'exist' },
    { character: '財', meaning: 'wealth' },
    { character: '罪', meaning: 'crime' },
    { character: '雑', meaning: 'miscellaneous' },
    { character: '酸', meaning: 'acid' },
    { character: '賛', meaning: 'approve' },
    { character: '支', meaning: 'support' },
    { character: '志', meaning: 'intention' },
    { character: '枝', meaning: 'branch' },
    { character: '師', meaning: 'teacher' },
    { character: '資', meaning: 'resources' },
    { character: '飼', meaning: 'raise animals' },
    { character: '示', meaning: 'show' },
    { character: '似', meaning: 'resemble' },
    { character: '識', meaning: 'knowledge' },
    { character: '質', meaning: 'quality' },
    { character: '舎', meaning: 'cottage' },
    { character: '謝', meaning: 'apologize' },
    { character: '授', meaning: 'impart' },
    { character: '修', meaning: 'discipline' },
    { character: '述', meaning: 'state' },
    { character: '術', meaning: 'art, technique' },
    { character: '準', meaning: 'standard' },
    { character: '序', meaning: 'preface' },
    { character: '招', meaning: 'invite' },
    { character: '承', meaning: 'consent' },
    { character: '証', meaning: 'evidence' },
    { character: '条', meaning: 'article' },
    { character: '状', meaning: 'condition' },
    { character: '常', meaning: 'usual' },
    { character: '情', meaning: 'emotion' },
    { character: '織', meaning: 'weave' },
    { character: '職', meaning: 'job' },
    { character: '制', meaning: 'system' },
    { character: '性', meaning: 'gender, nature' },
    { character: '政', meaning: 'politics' },
    { character: '勢', meaning: 'forces' },
    { character: '精', meaning: 'refined' },
    { character: '製', meaning: 'manufacture' },
    { character: '税', meaning: 'tax' },
    { character: '責', meaning: 'responsibility' },
    { character: '績', meaning: 'achievements' },
    { character: '接', meaning: 'contact' },
    { character: '設', meaning: 'establish' },
    { character: '舌', meaning: 'tongue' },
    { character: '絶', meaning: 'extinction' },
    { character: '銭', meaning: 'coin' },
    { character: '祖', meaning: 'ancestor' },
    { character: '素', meaning: 'element' },
    { character: '総', meaning: 'whole' },
    { character: '造', meaning: 'create' },
    { character: '像', meaning: 'image' },
    { character: '増', meaning: 'increase' },
    { character: '則', meaning: 'rule' },
    { character: '測', meaning: 'measure' },
    { character: '属', meaning: 'belong' },
    { character: '率', meaning: 'rate' },
    { character: '損', meaning: 'loss' },
    { character: '退', meaning: 'retreat' },
    { character: '貸', meaning: 'lend' },
    { character: '態', meaning: 'attitude' },
    { character: '団', meaning: 'group' },
    { character: '断', meaning: 'cut off' },
    { character: '築', meaning: 'build' },
    { character: '張', meaning: 'stretch' },
    { character: '提', meaning: 'propose' },
    { character: '程', meaning: 'extent' },
    { character: '適', meaning: 'suitable' },
    { character: '敵', meaning: 'enemy' },
    { character: '統', meaning: 'unite' },
    { character: '銅', meaning: 'copper' },
    { character: '導', meaning: 'guide' },
    { character: '徳', meaning: 'virtue' },
    { character: '独', meaning: 'alone' },
    { character: '任', meaning: 'responsibility' },
    { character: '燃', meaning: 'burn' },
    { character: '能', meaning: 'ability' },
    { character: '破', meaning: 'break' },
    { character: '犯', meaning: 'crime' },
    { character: '判', meaning: 'judge' },
    { character: '版', meaning: 'edition' },
    { character: '比', meaning: 'compare' },
    { character: '肥', meaning: 'fertilizer' },
    { character: '非', meaning: 'negative' },
    { character: '備', meaning: 'provide' },
    { character: '俵', meaning: 'sack' },
    { character: '評', meaning: 'evaluate' },
    { character: '貧', meaning: 'poor' },
    { character: '布', meaning: 'cloth' },
    { character: '婦', meaning: 'lady' },
    { character: '富', meaning: 'wealth' },
    { character: '武', meaning: 'military' },
    { character: '復', meaning: 'restore' },
    { character: '複', meaning: 'complex' },
    { character: '仏', meaning: 'Buddha' },
    { character: '編', meaning: 'compile' },
    { character: '弁', meaning: 'valve' },
    { character: '保', meaning: 'preserve' },
    { character: '墓', meaning: 'grave' },
    { character: '報', meaning: 'report' },
    { character: '豊', meaning: 'abundant' },
    { character: '防', meaning: 'prevent' },
    { character: '貿', meaning: 'trade' },
    { character: '暴', meaning: 'violence' },
    { character: '務', meaning: 'duty' },
    { character: '夢', meaning: 'dream' },
    { character: '迷', meaning: 'astray' },
    { character: '綿', meaning: 'cotton' },
    { character: '輸', meaning: 'transport' },
    { character: '余', meaning: 'surplus' },
    { character: '預', meaning: 'deposit' },
    { character: '容', meaning: 'contain' },
    { character: '略', meaning: 'abbreviation' },
    { character: '留', meaning: 'stay' },
    { character: '領', meaning: 'territory' }
  ];

  // Combine all grades
  return [
    ...grade1Kanji.map(k => ({ ...k, grade: 1 })),
    ...grade2Kanji.map(k => ({ ...k, grade: 2 })),
    ...grade3Kanji.map(k => ({ ...k, grade: 3 })),
    ...grade4Kanji.map(k => ({ ...k, grade: 4 })),
    ...grade5Kanji.map(k => ({ ...k, grade: 5 }))
  ];
};

// Insert kanji data
const insertSampleData = () => {
  const allKanji = parseKanjiData();
  
  const insertKanji = db.prepare('INSERT OR IGNORE INTO kanji (character, meaning, grade) VALUES (?, ?, ?)');
  
  allKanji.forEach(kanji => {
    insertKanji.run([kanji.character, kanji.meaning, kanji.grade]);
  });
  
  insertKanji.finalize();
};

// Initialize DB with sample data
const initialize = () => {
  initDB();
  insertSampleData();
};

module.exports = {
  db,
  initialize
};
